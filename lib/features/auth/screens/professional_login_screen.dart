import 'package:flutter/material.dart';import 'package:flutter_riverpod/flutter_riverpod.dart';import 'package:firebase_auth/firebase_auth.dart';import 'package:cloud_firestore/cloud_firestore.dart';import '../../../core/widgets/custom_app_bar.dart';import '../models/user_model.dart';import '../../assureur/screens/hierarchical_agent_dashboard.dart';import '../../expert/screens/expert_dashboard_screen.dart';  final String userType; // 'assureur' ou 'expert';            .collection('users';          final userType = userData['userType';          final accountStatus = userData['accountStatus'] as String? ?? 'active';          // Vérifier le type d';              _showError('Ce compte n\'est pas un compte ${widget.userType == 'assureur' ? 'agent d\'assurance' : 'expert'}.';          if (accountStatus == 'pending';              _showError('Votre compte est en attente de validation par un administrateur.';          } else if (accountStatus == 'rejected';              final reason = userData['rejectionReason'] as String? ?? 'Raison non spécifiée';              _showError('Votre compte a été rejeté. Raison: $reason';          } else if (accountStatus == 'suspended';              _showError('Votre compte a été suspendu. Contactez l\'administrateur.';            if (widget.userType == 'assureur';            _showError('Compte non trouvé dans la base de données.';      String message = 'Erreur de connexion';        case 'user-not-found';          message = 'Aucun compte trouvé avec cet email';        case 'wrong-password';          message = 'Mot de passe incorrect';        case 'invalid-email';          message = 'Email invalide';        case 'user-disabled';          message = 'Ce compte a été désactivé';        case 'too-many-requests';          message = 'Trop de tentatives. Réessayez plus tard';          message = 'Erreur: ${e.message}';        _showError('Erreur inattendue: $e';        content: Text('❌ $message';    final isAssureur = widget.userType == 'assureur';        title: isAssureur ? 'Connexion Agent d\'Assurance' : 'Connexion Expert';                    isAssureur ? 'Agent d\'Assurance' : 'Expert';                    'Connectez-vous à votre compte professionnel';                  labelText: 'Email professionnel';                  hintText: 'votre.email@exemple.com';                    return 'Veuillez saisir votre email';                  if (!RegExp(r'^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$';                    return 'Email invalide';                  labelText: 'Mot de passe';                  hintText: 'Votre mot de passe';                    return 'Veuillez saisir votre mot de passe';                          'Se connecter';                        content: Text('Fonctionnalité à venir';                  child: const Text('Mot de passe oublié ?';                            'Compte en attente de validation ?';                      'Votre compte doit être validé par un administrateur avant la première connexion. Vous recevrez un email de confirmation.';