import 'package:flutter/material.dart';import 'package:flutter_riverpod/flutter_riverpod.dart';import 'package:cloud_firestore/cloud_firestore.dart';import '../services/universal_auth_service.dart';import '../../assureur/screens/assureur_home_screen.dart';      debugPrint('[AgentLogin] ğŸ” DÃ©but connexion agent simple...';      debugPrint('[AgentLogin] Email: ${_emailController.text.trim()}';      // SYSTÃˆME D'APPROBATION COMPLEXE - VÃ©rifier d'abord si l';          .collection('agents_assurance';          .where('email';        // VÃ©rifier s';            .collection('professional_account_requests';            .where('email';          final statut = demande['status'] ?? 'pending';              case 'pending';                _errorMessage = 'â³ Votre demande est en attente d\'approbation.\n';                    'Un administrateur examine votre dossier.\n';                    'Vous recevrez un email de confirmation.';              case 'approved';                _errorMessage = 'âœ… Votre demande a Ã©tÃ© approuvÃ©e !\n';                    'Votre compte devrait Ãªtre actif.\n';                    'Si vous ne pouvez pas vous connecter, contactez l\'administration.';              case 'rejected';                final motif = demande['rejectionReason'] ?? 'Aucun motif spÃ©cifiÃ©';                _errorMessage = 'âŒ Votre demande a Ã©tÃ© refusÃ©e.\n';                    'Motif: $motif\n';                    'Contactez l\'administration pour plus d\'informations.';                _errorMessage = 'Statut de demande inconnu. Contactez l\'administration.';            _errorMessage = 'Aucun compte trouvÃ©.\n';                'Veuillez vous inscrire d\'abord ou vÃ©rifier votre email.';      // L';      if (result['success';        final userType = result['userType';        debugPrint('[AgentLogin] âœ… Connexion rÃ©ussie: $userType';              'âœ… Bienvenue ${result['prenom']} ${result['nom']}\n';              'Type: $userType\n';              'ğŸŒŸ Connexion universelle rÃ©ussie';        // Navigation vers l';          _errorMessage = result['error'] ?? 'Ã‰chec de la connexion. VÃ©rifiez vos identifiants.';      debugPrint('[AgentLogin] âŒ Erreur connexion: $e';      // Si l'agent n'existe pas, proposer la connexion d';      if (e.toString().contains('Profil agent non trouvÃ©';        debugPrint('[AgentLogin] ğŸš¨ Agent non trouvÃ©, utilisation connexion d\'urgence...';          _errorMessage = 'Erreur de connexion: ${e.toString()}';  /// ğŸš¨ Connexion d';    debugPrint('[AgentLogin] ğŸš¨ Tentative connexion d\'urgence pour: $email';    // Liste des identifiants valides pour la connexion d';      {'email': 'hammami123rahma@gmail.com', 'password': 'Acheya123';      {'email': 'agent@star.tn', 'password': 'agent123';      {'email': 'test@agent.com', 'password': 'test123';      if (email == cred['email'] && password == cred['password';      isValidCredentials = email.contains('agent.test';                          email.contains('agent.fallback';                          email.contains('@star.tn';                          email.contains('@gat.tn';                          email.contains('@bh.tn';                          email.contains('@maghrebia.tn';      debugPrint('[AgentLogin] âœ… Connexion d\'urgence validÃ©e pour: $email';            content: Text('ğŸš¨ Connexion d\'urgence rÃ©ussie\nBienvenue Agent Test';        // Navigation directe vers l';      debugPrint('[AgentLogin] âŒ Identifiants invalides pour connexion d\'urgence';            title: const Text('âŒ Identifiants incorrects';                Text('Identifiants valides pour la connexion d\'urgence :';                Text('â€¢ hammami123rahma@gmail.com / Acheya123';                Text('â€¢ agent@star.tn / agent123';                Text('â€¢ test@agent.com / test123';                Text('Ou tout email contenant :';                Text('â€¢ agent.test, @star.tn, @gat.tn, etc.';                child: const Text('OK';      debugPrint('[AgentLogin] ğŸ§ª CrÃ©ation des donnÃ©es de test...';              Text('CrÃ©ation des agents de test...';      debugPrint('[AgentLogin] Agents de test disponibles via le service universel';            content: Text('âœ… Agents de test crÃ©Ã©s avec succÃ¨s !';      debugPrint('[AgentLogin] âŒ Erreur crÃ©ation donnÃ©es test: $e';            content: Text('âŒ Erreur: $e';        title: const Text('Connexion Agent d\'Assurance';            tooltip: 'CrÃ©er agents de test';                        'Espace Agent d\'Assurance';                        'Connectez-vous avec vos identifiants professionnels';                // Message d';                    labelText: 'Email professionnel';                    hintText: 'agent@compagnie.tn';                      return 'Veuillez saisir votre email';                    if (!RegExp(r'^[^@]+@[^@]+\.[^@]+';                      return 'Format d\'email invalide';                    labelText: 'Mot de passe';                      return 'Veuillez saisir votre mot de passe';                      return 'Le mot de passe doit contenir au moins 6 caractÃ¨res';                // Message d'aide pour la connexion d';                        'ğŸ” CONNEXION AGENT SIMPLIFIÃ‰E';                        'Cliquez sur "CrÃ©er agents de test" (ğŸ§ª) puis utilisez: agent@star.tn / agent123';                          'ğŸ” SE CONNECTER';                        content: Text('Contactez votre responsable d\'agence pour rÃ©initialiser votre mot de passe';                  child: const Text('Mot de passe oubliÃ© ?';                        'Pas encore de compte agent ?';                          Navigator.pushNamed(context, '/agent-registration';                        label: const Text('S\'inscrire comme agent';                // Bouton de connexion d';                      const Text('ğŸš¨ Connexion d\'urgence';                        'Besoin d\'aide ?';                        'Contactez votre responsable d\'agence ou l\'administrateur systÃ¨me';