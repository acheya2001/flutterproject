import 'package:flutter/foundation.dart';import 'package:firebase_auth/firebase_auth.dart';import 'package:cloud_firestore/cloud_firestore.dart';/// ğŸŒŸ Service d'authentification universel - Fonctionne pour tous les types d';  /// ğŸ” Connexion universelle avec gestion d';      debugPrint('[UniversalAuth] ğŸ” DÃ©but connexion: $email';        debugPrint('[UniversalAuth] âœ… Connexion Firebase Auth directe rÃ©ussie';        debugPrint('[UniversalAuth] âš ï¸ Erreur Firebase Auth: $authError';        if (authError.toString().contains('PigeonUserDetails';          debugPrint('[UniversalAuth] ğŸ”§ Erreur PigeonUserDetails dÃ©tectÃ©e, contournement...';            debugPrint('[UniversalAuth] âœ… Contournement PigeonUserDetails rÃ©ussi: ${user.uid}';              'success';              'error': 'Erreur PigeonUserDetails - utilisateur non connectÃ©';            'success';            'error': 'Identifiants incorrects: ${authError.toString()}';          'success';          'error': 'Utilisateur non trouvÃ© aprÃ¨s connexion';      final collections = ['conducteurs', 'agents_assurance', 'experts';          debugPrint('[UniversalAuth] ğŸ” Recherche dans $collection...';            userType = userData['userType';            debugPrint('[UniversalAuth] âœ… DonnÃ©es trouvÃ©es dans $collection: $userType';          debugPrint('[UniversalAuth] âš ï¸ Erreur $collection: $firestoreError';        debugPrint('[UniversalAuth] âŒ Aucune donnÃ©e utilisateur trouvÃ©e pour: ${user.uid}';          'success';          'error': 'Compte non trouvÃ©. Veuillez vous inscrire d\'abord.';        'success';        'uid';        'email': userData['email';        'userType';        'nom': userData['nom']?.toString() ?? 'Utilisateur';        'prenom': userData['prenom']?.toString() ?? 'Firebase';        'pigeonWorkaround';        'userData';      debugPrint('[UniversalAuth] ğŸ‰ Connexion universelle rÃ©ussie: $userType (${user.uid})';      debugPrint('[UniversalAuth] âŒ Erreur gÃ©nÃ©rale: $e';        'success';        'error': 'Erreur de connexion: ${e.toString()}';      debugPrint('[UniversalAuth] ğŸ“ DÃ©but inscription: $email ($userType)';        debugPrint('[UniversalAuth] âš ï¸ Erreur Firebase Auth: $authError';        if (authError.toString().contains('PigeonUserDetails';          debugPrint('[UniversalAuth] ğŸ”§ Erreur PigeonUserDetails dÃ©tectÃ©e, contournement...';            debugPrint('[UniversalAuth] âœ… Contournement PigeonUserDetails rÃ©ussi: ${user.uid}';          debugPrint('[UniversalAuth] âŒ Erreur crÃ©ation compte: $authError';            'success';            'error': 'Erreur crÃ©ation compte: ${authError.toString()}';      // Si user n';          'success';          'error': 'Erreur crÃ©ation utilisateur';        'uid';        'email';        'nom';        'prenom';        'userType';        'createdAt';        'updatedAt';        debugPrint('[UniversalAuth] âœ… Profil crÃ©Ã© dans $collection';        debugPrint('[UniversalAuth] âŒ Erreur Firestore: $firestoreError';          'success';          'error': 'Erreur sauvegarde donnÃ©es';        'success';        'uid';        'email';        'nom';        'prenom';        'userType';        'message': 'Inscription rÃ©ussie !';      debugPrint('[UniversalAuth] âŒ Erreur gÃ©nÃ©rale inscription: $e';        'success';        'error': 'Erreur inscription: ${e.toString()}';      debugPrint('[UniversalAuth] ğŸšª DÃ©connexion rÃ©ussie';      debugPrint('[UniversalAuth] âŒ Erreur dÃ©connexion: $e';      case 'agents_assurance';        return 'assureur';      case 'experts';        return 'expert';      case 'conducteurs';        return 'conducteur';        return 'conducteur';  /// ğŸ“‚ Obtenir la collection pour un type d';      case 'assureur';        return 'agents_assurance';      case 'expert';        return 'experts';        return 'conducteurs';