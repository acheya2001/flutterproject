import 'package:cloud_firestore/cloud_firestore.dart';import ';/// 🔧 Service de reparation directe Firestore (contourne Firebase Auth';  /// 🔧 Creer directement le document Admin Compagnie avec l';      debugPrint(';      if (existingDoc.exists';        debugPrint(';        final data = existingDoc.data(';        debugPrint('[DIRECT_FIRESTORE_FIX] 📋 Donnees existantes: '{data['role']}';      // 2. Creer d';        'email': 'admin.compagnie@test.tn';        'nom': 'Admin';        'prenom': 'Compagnie';        'role': 'admin_compagnie';        'status': 'actif';        'compagnieId';        'compagnieNom': 'STAR Assurance';        'created_at: FieldValue.serverTimestamp(';        'updated_at: FieldValue.serverTimestamp(';        'created_by': 'direct_firestore_fix';        'isFakeData';        'last_login';        'password_reset_required';        'phone': '+216 71 123 456';        'address': '123 Avenue Habib Bourguiba, Tunis';          .collection(';          .set(userData';      debugPrint('[DIRECT_FIRESTORE_FIX] ✅ Document utilisateur cree avec succes';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 UID: 'knownUid';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 Email: admin.compagnie@test.tn';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 Rôle: admin_compagnie';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 CompagnieId: ';    } catch (e';      debugPrint(';      if (existingCompagnie.exists';        debugPrint('[DIRECT_FIRESTORE_FIX] ✅ Compagnie existe deja: 'compagnieId';        'nom': 'STAR Assurance';        'code': 'STAR';        'type': 'compagnie_assurance';        'status': 'actif';        'adresse': '123 Avenue Habib Bourguiba, Tunis';        'telephone': '+216 71 123 456';        'email': 'contact@star-assurance.tn';        'site_web': 'www.star-assurance.tn';        'created_at: FieldValue.serverTimestamp(';        'updated_at: FieldValue.serverTimestamp(';        'created_by': 'direct_firestore_fix';        'isFakeData';          .collection(';          .set(compagnieData';      debugPrint('[DIRECT_FIRESTORE_FIX] ✅ Compagnie creee: ';    } catch (e';      debugPrint('[DIRECT_FIRESTORE_FIX] ❌ Erreur creation compagnie:  + e.toString()';      return 'star-assurance-test';      if (!doc.exists';          'exists';          'uid';          'error': ';      final data = doc.data(';        'exists';        'uid';        'data';        'role': data['role';        'compagnieId': data['compagnieId';        'email': data[';    } catch (e';        'exists';        'error': 'Erreur verification: ';  static Future<bool> fullFix(';      debugPrint(';      final initialCheck = await checkDocument(';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 État initial: 'initialCheck';      if (initialCheck['exists] == true';        debugPrint(';      if (!created';        debugPrint(';      final finalCheck = await checkDocument(';      debugPrint('[DIRECT_FIRESTORE_FIX] 📋 État final: 'finalCheck';      if (finalCheck['exists] == true';        debugPrint('[DIRECT_FIRESTORE_FIX] ✅ Reparation complete reussie !';        debugPrint('[DIRECT_FIRESTORE_FIX] 🎯 Vous pouvez maintenant vous connecter';        debugPrint(';    } catch (e';      debugPrint(';  static Future<void> cleanTestData(';      debugPrint(';          .delete(';          .collection('compagnies_assurance';          .doc(';          .delete(';      debugPrint(';    } catch (e';      debugPrint(';  static Future<void> fullDiagnostic(';      debugPrint('\n' + '= * 60';      debugPrint('🔧 DIAGNOSTIC DIRECT FIRESTORE FIX';      debugPrint(';      final check = await checkDocument(';      debugPrint('📧 Email attendu: admin.compagnie@test.tn';      debugPrint('👤 UID connu: qNx15EZMASOBKpS6OpicoRQduP83';      debugPrint('🗄️ Document existe: '{check['exists'] ? '✅' : '❌'}';      if (check['exists] == true';        final data = check['data';        debugPrint('🎭 Rôle: '{data['role']}';        debugPrint('🏢 CompagnieId: '{data['compagnieId']}';        debugPrint('📊 Statut: '{data['status']}';        debugPrint('📧 Email: '{data['email']}';        debugPrint('❌ Erreur: '{check['error']}';      debugPrint('=' * 60 + ';    } catch (e';      debugPrint('[DIRECT_FIRESTORE_FIX] ❌ Erreur diagnostic: ';