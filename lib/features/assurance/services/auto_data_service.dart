import 'package:cloud_firestore/cloud_firestore.dart';import 'package:firebase_auth/firebase_auth.dart';import 'package:flutter/foundation.dart';// import '../models/assurance_data_model.dart';import '../../../core/utils/constants.dart';import 'dart:math';/// üè≠ Service de g√©n√©ration automatique de donn√©es d';  /// üöÄ G√©n√©rer automatiquement toutes les donn√©es d';      debugPrint('[AutoDataService] üöÄ G√©n√©ration automatique d√©marr√©e...';      // V√©rifier l';      // 1. Cr√©er les compagnies d';      debugPrint('[AutoDataService] ‚úÖ G√©n√©ration automatique termin√©e !';      debugPrint('[AutoDataService] üìä R√©sum√©:';      debugPrint('[AutoDataService]   - 8 compagnies d\'assurance';      debugPrint('[AutoDataService]   - $nombreClients clients';      debugPrint('[AutoDataService]   - $nombreVehicules v√©hicules assur√©s';      debugPrint('[AutoDataService]   - $nombreConstats constats';      debugPrint('[AutoDataService]   - Statistiques BI g√©n√©r√©es';      debugPrint('[AutoDataService] ‚ùå Erreur: $e';  /// üè¢ Cr√©er les compagnies d';    debugPrint('[AutoDataService] üè¢ Cr√©ation des compagnies...';        'id': 'STAR';        'nom': 'STAR Assurances';        'code': 'STAR';        'couleur': '#FF5722';        'logo': 'star_logo.png';        'slogan': 'Votre √©toile protectrice';        'siege_social': 'Avenue Habib Bourguiba, Tunis';        'telephone': '+216 71 123 456';        'email': 'contact@star.tn';        'site_web': 'www.star.tn';        'capital';        'agrement': 'AGR-STAR-2020';        'date_creation';        'id': 'MAGHREBIA';        'nom': 'Maghrebia Assurances';        'code': 'MAG';        'couleur': '#2196F3';        'logo': 'maghrebia_logo.png';        'slogan': 'L\'assurance de confiance';        'siege_social': 'Avenue Mohamed V, Tunis';        'telephone': '+216 71 789 012';        'email': 'contact@maghrebia.tn';        'site_web': 'www.maghrebia.tn';        'capital';        'agrement': 'AGR-MAG-2018';        'date_creation';        'id': 'GAT';        'nom': 'GAT Assurances';        'code': 'GAT';        'couleur': '#4CAF50';        'logo': 'gat_logo.png';        'slogan': 'Garantie et transparence';        'siege_social': 'Rue Ibn Khaldoun, Tunis';        'telephone': '+216 71 345 678';        'email': 'contact@gat.tn';        'site_web': 'www.gat.tn';        'capital';        'agrement': 'AGR-GAT-2019';        'date_creation';        'id': 'LLOYD';        'nom': 'Lloyd Tunisien';        'code': 'LLOYD';        'couleur': '#9C27B0';        'logo': 'lloyd_logo.png';        'slogan': 'Excellence et innovation';        'siege_social': 'Les Berges du Lac, Tunis';        'telephone': '+216 71 456 789';        'email': 'contact@lloyd.tn';        'site_web': 'www.lloyd.tn';        'capital';        'agrement': 'AGR-LLOYD-2017';        'date_creation';        'id': 'ASTREE';        'nom': 'Astr√©e Assurances';        'code': 'AST';        'couleur': '#FF9800';        'logo': 'astree_logo.png';        'slogan': 'Votre avenir assur√©';        'siege_social': 'Avenue de la Libert√©, Tunis';        'telephone': '+216 71 567 890';        'email': 'contact@astree.tn';        'site_web': 'www.astree.tn';        'capital';        'agrement': 'AGR-AST-2021';        'date_creation';        'id': 'CTAMA';        'nom': 'CTAMA';        'code': 'CTAMA';        'couleur': '#607D8B';        'logo': 'ctama_logo.png';        'slogan': 'Compagnie Tunisienne d\'Assurance';        'siege_social': 'Avenue Bourguiba, Tunis';        'telephone': '+216 71 678 901';        'email': 'contact@ctama.tn';        'site_web': 'www.ctama.tn';        'capital';        'agrement': 'AGR-CTAMA-2016';        'date_creation';        'id': 'SALIM';        'nom': 'Salim Assurances';        'code': 'SALIM';        'couleur': '#795548';        'logo': 'salim_logo.png';        'slogan': 'S√©curit√© et s√©r√©nit√©';        'siege_social': 'Rue de Marseille, Tunis';        'telephone': '+216 71 789 012';        'email': 'contact@salim.tn';        'site_web': 'www.salim.tn';        'capital';        'agrement': 'AGR-SALIM-2020';        'date_creation';        'id': 'ZITOUNA';        'nom': 'Zitouna Takaful';        'code': 'ZIT';        'couleur': '#009688';        'logo': 'zitouna_logo.png';        'slogan': 'Assurance islamique de confiance';        'siege_social': 'Avenue Hedi Chaker, Tunis';        'telephone': '+216 71 890 123';        'email': 'contact@zitouna.tn';        'site_web': 'www.zitouna.tn';        'capital';        'agrement': 'AGR-ZIT-2022';        'date_creation';      final agences = await _generateAgencesForCompany(company['id';        'agences';        'statistiques';        'produits';        'tarifs';        'created_at';        'updated_at';          .collection('assureurs_compagnies';          .doc(company['id';      'Tunis', 'Ariana', 'Ben Arous', 'Manouba', 'Nabeul', 'Zaghouan';      'Bizerte', 'B√©ja', 'Jendouba', 'Kef', 'Siliana', 'Sousse';      'Monastir', 'Mahdia', 'Sfax', 'Kairouan', 'Kasserine', 'Sidi Bouzid';      'Gab√®s', 'Medenine', 'Tataouine', 'Gafsa', 'Tozeur', 'Kebili';        'id': '${companyId}_${gouvernorat.toUpperCase()}_${(i + 1).toString().padLeft(3, '0')}';        'nom': 'Agence $gouvernorat ${i + 1}';        'adresse': '${_random.nextInt(200) + 1} ${_getRandomStreet()}, $gouvernorat';        'gouvernorat';        'telephone': '+216 ${_random.nextInt(90) + 10} ${_random.nextInt(900) + 100} ${_random.nextInt(900) + 100}';        'email': '${gouvernorat.toLowerCase()}@${companyId.toLowerCase()}.tn';        'responsable';        'horaires';          'lundi_vendredi': '08:00 - 17:00';          'samedi': '08:00 - 12:00';          'dimanche': 'Ferm√©';        'services';        'coordonnees';          'latitude';          'longitude';        'created_at';    debugPrint('[AutoDataService] üë• G√©n√©ration de $nombre clients...';      final docRef = _firestore.collection('clients_assurance';          debugPrint('[AutoDataService] üìä Clients: $progress% (${i + 1}/$nombre)';    debugPrint('[AutoDataService] üöó G√©n√©ration de $nombre v√©hicules assur√©s...';          debugPrint('[AutoDataService] üìä V√©hicules: $progress% (${i + 1}/$nombre)';    debugPrint('[AutoDataService] üìã G√©n√©ration de $nombre constats...';          debugPrint('[AutoDataService] üìä Constats: $progress% (${i + 1}/$nombre)';  /// üìä G√©n√©rer les statistiques d';    debugPrint('[AutoDataService] üìä G√©n√©ration des statistiques...';      'periode': '${DateTime.now().year}-${DateTime.now().month.toString().padLeft(2, '0')}';      'kpis_globaux';        'chiffre_affaires';        'nombre_contrats_actifs';        'nombre_sinistres';        'ratio_sinistralite';        'satisfaction_client';        'delai_moyen_indemnisation';      'repartition_par_compagnie';      'evolution_mensuelle';      'zones_risque';      'predictions';      'created_at';      'updated_at';        .doc('assurance_stats_${DateTime.now().year}_${DateTime.now().month}';    debugPrint('[AutoDataService] üë®‚Äçüíº Cr√©ation des utilisateurs assureurs...';    final companies = ['STAR', 'MAGHREBIA', 'GAT', 'LLOYD', 'ASTREE', 'CTAMA', 'SALIM', 'ZITOUNA';          'id': 'assureur_${company.toLowerCase()}_${i + 1}';          'email': 'assureur${i + 1}@${company.toLowerCase()}.tn';          'nom';          'prenom';          'telephone': '+216 ${_random.nextInt(90) + 10} ${_random.nextInt(900) + 100} ${_random.nextInt(900) + 100}';          'compagnie';          'poste';          'agence_id': '${company}_TUNIS_001';          'permissions';          'statut': 'actif';          'date_embauche';          'created_at';          'updated_at';            .collection('users_assureurs';            .doc(userData['id';  /// üîê S'assurer que l';      debugPrint('[AutoDataService] üîê Authentification anonyme...';      debugPrint('[AutoDataService] ‚úÖ Authentifi√© anonymement';      debugPrint('[AutoDataService] ‚úÖ Utilisateur d√©j√† authentifi√©: ${user.uid}';      'total_contrats';      'contrats_actifs';      'sinistres_annee';      'chiffre_affaires';      'ratio_sinistralite';      {'nom': 'Responsabilit√© Civile', 'prix_base': 180, 'description': 'Couverture minimale obligatoire';      {'nom': 'Tiers Complet', 'prix_base': 350, 'description': 'RC + Vol + Incendie + Bris de glace';      {'nom': 'Tous Risques', 'prix_base': 650, 'description': 'Couverture compl√®te tous dommages';      {'nom': 'Conducteur', 'prix_base': 120, 'description': 'Protection du conducteur';      'jeune_conducteur';      'conducteur_experimente';      'senior';      'malus';      'bonus_max';      'franchise_mini';      'franchise_maxi';      'Souscription contrats', 'D√©claration sinistres', 'Expertise v√©hicules';      'Conseil personnalis√©', 'Assistance 24h/24', 'Renouvellement automatique';      'Avenue Habib Bourguiba', 'Rue de la R√©publique', 'Avenue Mohamed V';      'Rue Ibn Khaldoun', 'Avenue de la Libert√©', 'Rue de Marseille';      'Avenue Hedi Chaker', 'Rue du Lac', 'Avenue de Carthage';    final prenoms = ['Ahmed', 'Mohamed', 'Ali', 'Fatma', 'Aicha', 'Salma', 'Karim', 'Nour';    final noms = ['Ben Ahmed', 'Trabelsi', 'Khelifi', 'Mansouri', 'Gharbi', 'Sassi';    return '${prenoms[_random.nextInt(prenoms.length)]} ${noms[_random.nextInt(noms.length)]}';    final prenoms = ['Ahmed', 'Mohamed', 'Ali', 'Karim', 'Sami', 'Fatma', 'Aicha', 'Salma', 'Nour', 'Ines';    final noms = ['Ben Ahmed', 'Trabelsi', 'Khelifi', 'Mansouri', 'Gharbi', 'Sassi', 'Mejri', 'Dridi';    final postes = ['Gestionnaire Sinistres', 'Conseiller Commercial', 'Expert Auto', 'Responsable Agence';    final permissions = ['consulter_contrats', 'gerer_sinistres', 'valider_expertises', 'generer_rapports';      'nom';      'prenom';      'cin': '${_random.nextInt(90000000) + 10000000}';      'telephone': '+216 ${_random.nextInt(90) + 10} ${_random.nextInt(900) + 100} ${_random.nextInt(900) + 100}';      'email': '${_getRandomFirstName().toLowerCase()}@email.com';      'adresse': '${_random.nextInt(200) + 1} ${_getRandomStreet()}';      'date_naissance';      'created_at';    final companies = ['STAR', 'MAGHREBIA', 'GAT', 'LLOYD', 'ASTREE', 'CTAMA', 'SALIM', 'ZITOUNA';    final marques = ['Peugeot', 'Renault', 'Volkswagen', 'Citro√´n', 'Fiat', 'Hyundai';      'client_id';      'assureur_id';      'numero_contrat': 'CTR-${DateTime.now().year}-${_random.nextInt(999999).toString().padLeft(6, '0')}';      'marque';      'modele': 'Mod√®le ${_random.nextInt(10) + 1}';      'immatriculation': '${_random.nextInt(900) + 100} TUN ${_random.nextInt(900) + 100}';      'annee';      'valeur_vehicule';      'type_couverture': ['RC', 'Tiers Complet', 'Tous Risques';      'prime_annuelle';      'franchise';      'date_debut';      'date_fin';      'statut': 'actif';      'created_at';      'vehicule_id';      'client_id';      'date_accident';      'lieu_accident': '${_getRandomStreet()}, Tunis';      'description': 'Accident de circulation';      'montant_estime';      'statut': ['en_attente', 'en_cours', 'clos';      'created_at';      'STAR';      'MAGHREBIA';      'GAT';      'LLOYD';        'mois': '${date.year}-${date.month.toString().padLeft(2, '0')}';        'contrats';        'sinistres';        'chiffre_affaires';    final zones = ['Tunis Centre', 'Sfax', 'Sousse', 'Nabeul', 'Bizerte';      'zone';      'niveau_risque';      'nombre_sinistres';      'sinistres_prevus_trimestre';      'croissance_contrats';      'zones_attention': ['Tunis Centre', 'Autoroute A1';