import 'package:cloud_firestore/cloud_firestore.dart';import 'package:flutter/foundation.dart';import '../models/insurance_contract.dart';/// ğŸ¢ Service de gestion des contrats d';  static const String _contractsCollection = 'insurance_contracts';  static const String _vehiclesCollection = 'vehicles';  /// ğŸ“‹ CrÃ©er un nouveau contrat d';      debugPrint('ğŸ” [InsuranceService] CrÃ©ation contrat: ${contract.numeroContrat}';      // VÃ©rifier l';          .where('numeroContrat';          .where('compagnieAssurance';        throw Exception('Un contrat avec ce numÃ©ro existe dÃ©jÃ  pour cette compagnie';      // CrÃ©er d';      // CrÃ©er le contrat avec l';      debugPrint('âœ… [InsuranceService] Contrat crÃ©Ã©: ${contractRef.id}';      debugPrint('âŒ [InsuranceService] Erreur crÃ©ation contrat: $e';  /// ğŸ“¥ RÃ©cupÃ©rer les contrats d';      debugPrint('ğŸ” [InsuranceService] RÃ©cupÃ©ration contrats agent: $agentId';          .where('agentId';          .orderBy('createdAt';      debugPrint('âœ… [InsuranceService] ${contracts.length} contrats trouvÃ©s';      debugPrint('âŒ [InsuranceService] Erreur rÃ©cupÃ©ration contrats: $e';      debugPrint('ğŸ” [InsuranceService] Recherche contrat: $numeroContrat ($compagnie)';          .where('numeroContrat';          .where('compagnieAssurance';        debugPrint('âŒ [InsuranceService] Contrat non trouvÃ©';      debugPrint('âœ… [InsuranceService] Contrat trouvÃ©: ${contract.id}';      debugPrint('âŒ [InsuranceService] Erreur recherche contrat: $e';      debugPrint('ğŸ” [InsuranceService] Recherche vÃ©hicule: $immatriculation';          .where('vehicule.numeroImmatriculation';      debugPrint('âœ… [InsuranceService] ${contracts.length} contrats trouvÃ©s pour le vÃ©hicule';      debugPrint('âŒ [InsuranceService] Erreur recherche vÃ©hicule: $e';      debugPrint('ğŸ” [InsuranceService] Mise Ã  jour contrat: $contractId';      updates['updatedAt';      debugPrint('âœ… [InsuranceService] Contrat mis Ã  jour';      debugPrint('âŒ [InsuranceService] Erreur mise Ã  jour contrat: $e';  /// ğŸ”„ Changer le statut d';      debugPrint('ğŸ” [InsuranceService] Changement statut contrat: $contractId -> $isActive';        'isActive';      debugPrint('âœ… [InsuranceService] Statut contrat mis Ã  jour';      debugPrint('âŒ [InsuranceService] Erreur changement statut: $e';      debugPrint('ğŸ” [InsuranceService] Suppression contrat: $contractId';      // RÃ©cupÃ©rer le contrat pour obtenir l';        debugPrint('âœ… [InsuranceService] Contrat et vÃ©hicule supprimÃ©s';      debugPrint('âŒ [InsuranceService] Erreur suppression contrat: $e';  /// ğŸ“Š Statistiques des contrats d';      debugPrint('ğŸ” [InsuranceService] Statistiques agent: $agentId';          .where('agentId';        'total';        'actifs';        'inactifs';        'expires';        'expirentBientot';      debugPrint('âœ… [InsuranceService] Statistiques calculÃ©es: $stats';      debugPrint('âŒ [InsuranceService] Erreur calcul statistiques: $e';      debugPrint('ğŸ” [InsuranceService] Recherche avancÃ©e contrats';        query = query.where('numeroContrat';        query = query.where('compagnieAssurance';        query = query.where('isActive';        query = query.where('agentId';      debugPrint('âœ… [InsuranceService] ${contracts.length} contrats trouvÃ©s';      debugPrint('âŒ [InsuranceService] Erreur recherche avancÃ©e: $e';