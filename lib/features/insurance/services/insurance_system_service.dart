import 'package:cloud_firestore/cloud_firestore.dart';import 'package:flutter/foundation.dart';import '../models/insurance_system_models.dart';/// 🏢 Service principal pour le systeme d';  // ==================== COMPAGNIES D';          .collection(FirebaseCollections.compagnies';          .where('isActive, isEqualTo: true';          .orderBy(';    } catch (e';      debugPrint('❌ Erreur lors de la recuperation des compagnies:  + e.toString()';  /// 🏢 Creer une nouvelle compagnie d';      debugPrint('✅ Compagnie creee avec succes: ';    } catch (e';      debugPrint('❌ Erreur lors de la creation de la compagnie:  + e.toString()';  /// 🏪 Obtenir les agences d';          .where('compagnieId, isEqualTo: compagnieId';          .where('isActive, isEqualTo: true';          .orderBy(';    } catch (e';      debugPrint(';          .add(agence.toMap()';      debugPrint('✅ Agence creee avec succes: ';    } catch (e';      debugPrint('❌ Erreur lors de la creation de l\'agence:  + e.toString()';  /// 👨‍💼 Obtenir les agents d';          .where('agenceId, isEqualTo: agenceId';          .where('statut', isEqualTo: 'actif';          .orderBy(';    } catch (e';      debugPrint(';          .add(agent.toMap()';      debugPrint('✅ Agent cree avec succes: ';    } catch (e';      debugPrint('❌ Erreur lors de la creation de l\';    } catch (e';      debugPrint(';          .add(client.toMap()';      debugPrint('✅ Client cree avec succes: ';    } catch (e';      debugPrint(';          .collection(FirebaseCollections.clients';          .where(';          .collection(FirebaseCollections.clients';          .where(';    } catch (e';      debugPrint('❌ Erreur lors de la recherche du client:  + e.toString()';  /// 🚙 Obtenir les vehicules d';          .where('proprietaireId, isEqualTo: clientId';          .orderBy(';    } catch (e';      debugPrint(';          .add(vehicule.toMap()';      debugPrint('✅ Vehicule cree avec succes: ';    } catch (e';      debugPrint(';          .collection(FirebaseCollections.vehicules';          .where(';    } catch (e';      debugPrint('❌ Erreur lors de la recherche du vehicule:  + e.toString()';  /// 📄 Obtenir les contrats d';          .where('clientId, isEqualTo: clientId';          .orderBy(';    } catch (e';      debugPrint(';      await _updateClientContrats(contrat.clientId, docRef.id';      debugPrint('✅ Contrat cree avec succes: ';    } catch (e';      debugPrint(';          .collection(FirebaseCollections.contrats';          .where(';    } catch (e';      debugPrint('❌ Erreur lors de la recherche du contrat:  + e.toString()';  /// 🔄 Mettre a jour les contrats d';        'contratIds: FieldValue.arrayUnion([contratId';        ';    } catch (e';      debugPrint('❌ Erreur lors de la mise a jour du vehicule:  + e.toString()';  /// 🔄 Mettre a jour les contrats d';        'contratIds: FieldValue.arrayUnion([contratId';        ';    } catch (e';      debugPrint(';    } catch (e';      debugPrint(';    } catch (e';      debugPrint('❌ Erreur lors de la recuperation de la compagnie: ';