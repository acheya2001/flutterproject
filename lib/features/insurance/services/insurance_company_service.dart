import 'package:flutter/foundation.dart';import 'package:cloud_firestore/cloud_firestore.dart';import '../models/compagnie_model.dart';import '../models/agent_model.dart';/// ğŸ¢ Service de gestion des compagnies d';  static const String _compagniesCollection = 'compagnies_assurance';  static const String _agencesCollection = 'agences_assurance';  static const String _agentsCollection = 'agents_assurance';  static const String _expertsCollection = 'experts_assurance';  /// ğŸ¢ CrÃ©er les compagnies d';    debugPrint('[InsuranceService] ğŸ¢ Initialisation des compagnies principales...';        'nom': 'STAR Assurances';        'logo': 'https://example.com/star-logo.png';        'adresse_siege': 'Avenue Habib Bourguiba, Tunis';        'telephone': '+216 71 340 000';        'email': 'contact@star.com.tn';        'site_web': 'https://www.star.com.tn';        'numero_agrement': 'AGR-STAR-001';        'types_assurance': ['Automobile', 'Habitation', 'Vie', 'SantÃ©';        'nom': 'Maghrebia Assurances';        'logo': 'https://example.com/maghrebia-logo.png';        'adresse_siege': 'Rue de la LibertÃ©, Tunis';        'telephone': '+216 71 250 000';        'email': 'contact@maghrebia.com.tn';        'site_web': 'https://www.maghrebia.com.tn';        'numero_agrement': 'AGR-MAGH-001';        'types_assurance': ['Automobile', 'Habitation', 'Vie';        'nom': 'Assurances Salim';        'logo': 'https://example.com/salim-logo.png';        'adresse_siege': 'Avenue Mohamed V, Tunis';        'telephone': '+216 71 180 000';        'email': 'contact@salim.com.tn';        'site_web': 'https://www.salim.com.tn';        'numero_agrement': 'AGR-SALIM-001';        'types_assurance': ['Automobile', 'Habitation';        'nom': 'GAT Assurances';        'logo': 'https://example.com/gat-logo.png';        'adresse_siege': 'Rue Ibn Khaldoun, Tunis';        'telephone': '+216 71 290 000';        'email': 'contact@gat.com.tn';        'site_web': 'https://www.gat.com.tn';        'numero_agrement': 'AGR-GAT-001';        'types_assurance': ['Automobile', 'Transport';            .where('nom', isEqualTo: companyData['nom';            id: '';            nom: companyData['nom';            logo: companyData['logo';            adresseSiege: companyData['adresse_siege';            telephone: companyData['telephone';            email: companyData['email';            siteWeb: companyData['site_web';            numeroAgrement: companyData['numero_agrement';            typesAssurance: List<String>.from(companyData['types_assurance';              'nombre_agences';              'nombre_agents';              'nombre_clients';              'nombre_contrats';          debugPrint('[InsuranceService] âœ… Compagnie crÃ©Ã©e: ${companyData['nom']} (${docRef.id})';          debugPrint('[InsuranceService] âš ï¸ Compagnie existe dÃ©jÃ : ${companyData['nom']}';        debugPrint('[InsuranceService] âŒ Erreur crÃ©ation ${companyData['nom']}: $e';    debugPrint('[InsuranceService] ğŸª CrÃ©ation des agences...';      'Tunis', 'Ariana', 'Ben Arous', 'Manouba';      'Sfax', 'Sousse', 'Monastir', 'Mahdia';      'Bizerte', 'Nabeul', 'Zaghouan', 'Siliana';      'Kairouan', 'Kasserine', 'Sidi Bouzid';      'Gafsa', 'Tozeur', 'Kebili', 'Gabes';      'Medenine', 'Tataouine', 'Le Kef', 'Jendouba', 'Beja';      final compagnieNom = companyDoc.data()['nom';          // VÃ©rifier si l';              .where('compagnie_id';              .where('gouvernorat';              id: '';              nom: '$compagnieNom - Agence $gouvernorat';              adresse: 'Avenue Principale, $gouvernorat';              codePostal: '${1000 + i}';              telephone: '+216 ${70 + i} ${100 + i} ${200 + i}';              email: '${gouvernorat.toLowerCase()}@${compagnieNom.toLowerCase().replaceAll(' ', '')}.tn';              responsable: 'Responsable $gouvernorat';                'nombre_agents';                'nombre_clients';                'nombre_contrats';            debugPrint('[InsuranceService] âœ… Agence crÃ©Ã©e: ${agence.nom} (${docRef.id})';          debugPrint('[InsuranceService] âŒ Erreur crÃ©ation agence $gouvernorat pour $compagnieNom: $e';          .where('active';          .orderBy('nom';      debugPrint('[InsuranceService] âŒ Erreur rÃ©cupÃ©ration compagnies: $e';  /// ğŸª Obtenir les agences d';          .where('compagnie_id';          .where('active';          .orderBy('nom';      debugPrint('[InsuranceService] âŒ Erreur rÃ©cupÃ©ration agences: $e';  /// ğŸ‘¨â€ğŸ’¼ Obtenir les agents d';          .where('agence_id';          .where('account_status', isEqualTo: 'active';          .orderBy('nom';      debugPrint('[InsuranceService] âŒ Erreur rÃ©cupÃ©ration agents: $e';  /// ğŸ“ˆ Mettre Ã  jour les statistiques d';          .where('compagnie_id';          .where('active';          .where('compagnie_id';          .where('account_status', isEqualTo: 'active';        'statistiques.nombre_agences';        'statistiques.nombre_agents';        'date_modification';      debugPrint('[InsuranceService] âœ… Statistiques mises Ã  jour pour: $compagnieId';      debugPrint('[InsuranceService] âŒ Erreur mise Ã  jour statistiques: $e';  /// ğŸ”„ Initialisation complÃ¨te du systÃ¨me d';    debugPrint('[InsuranceService] ğŸš€ Initialisation complÃ¨te du systÃ¨me...';      'compagnies_created';      'agences_created';      'errors';      results['compagnies_created';      debugPrint('[InsuranceService] ğŸ‰ SystÃ¨me d\'assurance initialisÃ© avec succÃ¨s';      debugPrint('[InsuranceService] âŒ Erreur initialisation systÃ¨me: $e';      (results['errors'] as List<String>).add('Erreur gÃ©nÃ©rale: $e';