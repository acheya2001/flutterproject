import 'package:flutter/foundation.dart';import 'package:cloud_firestore/cloud_firestore.dart';import '../models/contrat_model.dart';import '../models/vehicule_assure_model.dart';import '../../vehicule/models/vehicule_model.dart';import '../models/compagnie_model.dart';/// ğŸ“„ Service de gestion des contrats d';  static const String _contratsCollection = 'contrats_assurance';  static const String _vehiculesAssuresCollection = 'vehicules_assures';  static const String _vehiculesCollection = 'vehicules';  static const String _compagniesCollection = 'compagnies_assurance';  static const String _agencesCollection = 'agences_assurance';  /// ğŸ“„ CrÃ©er un nouveau contrat d';      debugPrint('[ContratService] ğŸ“„ CrÃ©ation d\'un nouveau contrat...';        id: '';      debugPrint('[ContratService] âœ… Contrat crÃ©Ã©: ${docRef.id}';      // CrÃ©er l';        numeroQuittance: numeroQuittance ?? '';      debugPrint('[ContratService] âŒ Erreur crÃ©ation contrat: $e';  /// ğŸš— CrÃ©er l';      id: '';    debugPrint('[ContratService] âœ… VÃ©hicule assurÃ© crÃ©Ã© pour contrat: $contratId';      String codeCompagnie = 'ASS';        final nom = compagnieDoc.data()!['nom';        if (nom.contains('STAR') codeCompagnie = 'STAR';        else if (nom.contains('Maghrebia') codeCompagnie = 'MAGH';        else if (nom.contains('Salim') codeCompagnie = 'SALIM';        else if (nom.contains('GAT') codeCompagnie = 'GAT';          .where('compagnie_id';      final numeroSequentiel = (contratsSnapshot.docs.length + 1).toString().padLeft(6, '0';      return '$codeCompagnie-$annee-$numeroSequentiel';      debugPrint('[ContratService] âŒ Erreur gÃ©nÃ©ration numÃ©ro: $e';      return 'ASS-${DateTime.now().year}-${DateTime.now().millisecondsSinceEpoch.toString().substring(7)}';  /// ğŸš— Obtenir les vÃ©hicules assurÃ©s d';      debugPrint('[ContratService] ğŸš— RÃ©cupÃ©ration vÃ©hicules pour: $conducteurId';          .where('proprietaireId';        // Chercher l';            .where('vehicule_id';            .where('conducteur_id';            .where('actif';            compagnieNom = compagnieDoc.data()!['nom';          // RÃ©cupÃ©rer le nom de l';            agenceNom = agenceDoc.data()!['nom';      debugPrint('[ContratService] âœ… ${vehiculesAvecAssurance.length} vÃ©hicules rÃ©cupÃ©rÃ©s';      debugPrint('[ContratService] âŒ Erreur rÃ©cupÃ©ration vÃ©hicules: $e';  /// ğŸ“„ Obtenir les contrats d';          .where('conducteur_id';          .orderBy('date_creation';      debugPrint('[ContratService] âŒ Erreur rÃ©cupÃ©ration contrats: $e';  /// ğŸ“„ Obtenir les contrats d';          .where('agence_id';          .orderBy('date_creation';      debugPrint('[ContratService] âŒ Erreur rÃ©cupÃ©ration contrats agence: $e';        'date_fin';        'date_modification';        'status';          .where('contrat_id';          'date_fin_couverture';          'date_modification';          'actif';      debugPrint('[ContratService] âœ… Contrat renouvelÃ©: $contratId';      debugPrint('[ContratService] âŒ Erreur renouvellement: $e';        'status';        'date_modification';        'conditions.motif_resiliation';          .where('contrat_id';          'actif';          'date_modification';      debugPrint('[ContratService] âœ… Contrat rÃ©siliÃ©: $contratId';      debugPrint('[ContratService] âŒ Erreur rÃ©siliation: $e';