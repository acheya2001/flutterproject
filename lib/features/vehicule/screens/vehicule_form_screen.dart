import 'dart:io';import 'package:flutter/material.dart';import 'package:flutter_riverpod/flutter_riverpod.dart';import 'package:image_picker/image_picker.dart';import 'package:intl/intl.dart';import '../../../utils/connectivity_utils.dart';import '../models/vehicule_model.dart';import '../providers/vehicule_provider.dart';import '../../auth/providers/auth_provider.dart';  // Listes d';    'Renault', 'Peugeot', 'Citroën', 'Volkswagen', 'BMW', 'Mercedes';    'Audi', 'Toyota', 'Hyundai', 'Kia', 'Nissan', 'Ford', 'Opel';    'Fiat', 'Seat', 'Skoda', 'Dacia', 'Suzuki', 'Mazda', 'Honda';    'STAR', 'GAT', 'COMAR', 'MAGHREBIA', 'LLOYD TUNISIEN';    'ASTREE', 'CTAMA', 'ZITOUNA TAKAFUL', 'SALIM', 'CARTE';      debugPrint('[VehiculeFormScreen] Erreur lors de la sélection de l\'image: $e';        _showSnackBar('Erreur lors de la sélection de l\'image';              const Text('Sélectionner une source';                title: 'Galerie';                subtitle: 'Choisir depuis la galerie';                title: 'Appareil photo';                subtitle: 'Prendre une nouvelle photo';      _showSnackBar('Veuillez sélectionner les dates de validité';    // Réinitialiser l';        throw Exception('Pas de connexion internet. Veuillez vérifier votre connexion et réessayer.';        throw Exception('Utilisateur non authentifié';            ? 'Véhicule ajouté avec succès';            : 'Véhicule mis à jour avec succès';        // Personnaliser le message d'erreur selon le type d';        if (e.toString().contains('TimeoutException') || e.toString().contains('timeout';          userFriendlyMessage = 'Le téléchargement prend trop de temps.\n\nConseils :\n• Vérifiez votre connexion internet\n• Utilisez des images plus petites\n• Réessayez dans quelques instants';        } else if (e.toString().contains('network') || e.toString().contains('connection';          userFriendlyMessage = 'Problème de connexion internet.\nVeuillez vérifier votre connexion et réessayer.';        } else if (e.toString().contains('permission') || e.toString().contains('denied';          userFriendlyMessage = 'Vous n\'avez pas les autorisations nécessaires.\nVeuillez contacter l\'administrateur.';          userFriendlyMessage = 'Une erreur est survenue.\nVeuillez réessayer.';    final dateFormat = DateFormat('dd/MM/yyyy';        title: Text(isEditing ? 'Modifier le véhicule' : 'Ajouter un véhicule';                      title: 'Informations du véhicule';                          label: 'Immatriculation';                          hint: 'Ex: 123 TUN 9815';                              return 'Veuillez entrer l\'immatriculation';                          label: 'Marque';                          hint: 'Ex: Renault, Peugeot, BMW...';                          label: 'Modèle';                          hint: 'Ex: 208, Clio, Golf...';                              return 'Veuillez entrer le modèle';                      title: 'Photos de la carte grise';                                title: 'Recto';                                title: 'Verso';                      title: 'Informations d\'assurance';                          label: 'Compagnie d\'assurance';                          hint: 'Ex: STAR, GAT, COMAR...';                          label: 'Numéro de contrat';                          hint: 'Ex: CT123456789';                              return 'Veuillez entrer le numéro de contrat';                          label: 'Quittance';                          hint: 'Ex: QP2024N000042230';                              return 'Veuillez entrer la quittance';                          label: 'Agence';                          hint: 'Ex: Tunis Centre, Sfax...';                              return 'Veuillez entrer l\'agence';                                label: 'Début de validité';                                label: 'Fin de validité';      statusMessage = 'Compression des images...';      statusMessage = 'Téléchargement des photos...';      statusMessage = 'Enregistrement du véhicule...';      statusMessage = 'Finalisation...';                        '$progressPercentage%';                'Veuillez patienter, cela peut prendre quelques instants...';              // Conseils pour l';                          'Conseils';                      '• Gardez une connexion internet stable\n• Ne fermez pas l\'application\n• Le téléchargement peut prendre du temps selon la taille des images';              // Bouton d';                  child: const Text('Annuler et réessayer';              return 'Veuillez entrer $label';                            'Ajouter une photo';                        : 'Sélectionner une date';                          isEditing ? 'Mettre à jour' : 'Ajouter le véhicule';