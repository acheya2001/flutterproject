import 'package:flutter/foundation.dart';import 'package:url_launcher/url_launcher.dart';/// ğŸš€ Service d';      debugPrint('[EmailService] === ENVOI EMAIL GÃ‰NÃ‰RIQUE ===';      debugPrint('[EmailService] ğŸ“§ Destinataire: $to';      debugPrint('[EmailService] ğŸ“‹ Sujet: $subject';      // Validation de l';        throw Exception('Format d\'email invalide: $to';      // Tentative d'ouverture de l';      debugPrint('[EmailService] âœ… Email envoyÃ© Ã : $to';      debugPrint('[EmailService] âŒ Erreur envoi email: $e';      debugPrint('[EmailService] === ENVOI INVITATION ===';      debugPrint('[EmailService] ğŸ“§ Destinataire: $email';      debugPrint('[EmailService] ğŸ”‘ Code session: $sessionCode';      debugPrint('[EmailService] ğŸ†” ID session: $sessionId';      // Validation de l';        throw Exception('Format d\'email invalide: $email';      // CrÃ©er le contenu de l';      // Tentative d'ouverture de l';      debugPrint('[EmailService] âœ… Invitation traitÃ©e pour: $email';      debugPrint('[EmailService] âŒ Erreur: $e';  /// ğŸ“± Affiche le contenu de l';    debugPrint('[EmailService] ';    debugPrint('[EmailService] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—';    debugPrint('[EmailService] â•‘                    ğŸ“§ EMAIL Ã€ ENVOYER                    â•‘';    debugPrint('[EmailService] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£';    debugPrint('[EmailService] â•‘ ğŸ“§ DESTINATAIRE: $email';    debugPrint('[EmailService] â•‘ ğŸ“‹ SUJET: Invitation - Constat d\'accident collaboratif';    debugPrint('[EmailService] â•‘ ğŸ”‘ CODE SESSION: $sessionCode';    debugPrint('[EmailService] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£';    debugPrint('[EmailService] â•‘ ğŸ“ MESSAGE:';    debugPrint('[EmailService] â•‘';    final lines = content.split('\n';      debugPrint('[EmailService] â•‘ $line';    debugPrint('[EmailService] â•‘';    debugPrint('[EmailService] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•';    debugPrint('[EmailService] ';    debugPrint('[EmailService] ğŸ¯ ACTIONS POSSIBLES:';    debugPrint('[EmailService] 1. ğŸ“‹ COPIEZ le contenu ci-dessus';    debugPrint('[EmailService] 2. ğŸ“§ ENVOYEZ-LE Ã : $email';    debugPrint('[EmailService] 3. ğŸ”‘ PARTAGEZ le code: $sessionCode';    debugPrint('[EmailService] ';  /// ğŸ“± Ouvre l';      debugPrint('[EmailService] ğŸ“± Tentative d\'ouverture de l\'app email...';      final subject = Uri.encodeComponent('Invitation - Constat d\'accident collaboratif';      final mailtoUrl = 'mailto:$email?subject=$subject&body=$body';        debugPrint('[EmailService] âœ… Application email ouverte';        debugPrint('[EmailService] ğŸ“§ IMPORTANT: Appuyez sur ENVOYER dans votre app email!';        debugPrint('[EmailService] âš ï¸ Impossible d\'ouvrir l\'app email';        debugPrint('[EmailService] ğŸ’¡ Utilisez le contenu affichÃ© dans les logs ci-dessus';      debugPrint('[EmailService] âŒ Erreur ouverture app email: $e';      debugPrint('[EmailService] ğŸ’¡ Utilisez le contenu affichÃ© dans les logs ci-dessus';  /// ğŸ“ CrÃ©e le contenu de l'email d';    return ''';Vous avez Ã©tÃ© invitÃ©(e) Ã  participer Ã  un constat d'accident collaboratif via l';1. Ouvrez l';Si vous n'avez pas l';L';Code: $sessionCode''';  /// ğŸ“± Affiche le contenu de l';    debugPrint('[EmailService] ';    debugPrint('[EmailService] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—';    debugPrint('[EmailService] â•‘                    ğŸ“§ EMAIL GÃ‰NÃ‰RIQUE                    â•‘';    debugPrint('[EmailService] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£';    debugPrint('[EmailService] â•‘ ğŸ“§ DESTINATAIRE: $to';    debugPrint('[EmailService] â•‘ ğŸ“‹ SUJET: $subject';    debugPrint('[EmailService] â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£';    debugPrint('[EmailService] â•‘ ğŸ“„ CONTENU:';    final lines = htmlBody.split('\n';      debugPrint('[EmailService] â•‘ $line';      debugPrint('[EmailService] â•‘ ... (contenu tronquÃ©)';    debugPrint('[EmailService] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•';    debugPrint('[EmailService] ';  /// ğŸ“± Tente d'ouvrir l';      // Convertir HTML en texte simple pour l';          .replaceAll(RegExp(r'<[^>]*>'), '';          .replaceAll('&nbsp;', ' ';          .replaceAll('&amp;', '&';          .replaceAll('&lt;', '<';          .replaceAll('&gt;', '>';      final emailUrl = 'mailto:$to?subject=${Uri.encodeComponent(subject)}&body=${Uri.encodeComponent(textBody)}';      debugPrint('[EmailService] ğŸ“± Tentative ouverture app email...';      debugPrint('[EmailService] ğŸ”— URL: ${emailUrl.substring(0, 100)}...';        debugPrint('[EmailService] âœ… App email ouverte';        debugPrint('[EmailService] âš ï¸ Impossible d\'ouvrir l\'app email';      debugPrint('[EmailService] âŒ Erreur ouverture app email: $e';      debugPrint('[EmailService] ğŸ’¡ Utilisez le contenu affichÃ© dans les logs ci-dessus';    final emailRegex = RegExp(r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$';