import 'dart:io';import 'package:firebase_storage/firebase_storage.dart';import 'package:flutter/foundation.dart';/// ğŸ“¸ Service d'upload d';      debugPrint('[ImageUpload] ğŸ“¤ Upload image: $folder/$fileName';      final ref = _storage.ref().child('$folder/$fileName';      // Attendre la fin de l';      // RÃ©cupÃ©rer l';      debugPrint('[ImageUpload] âœ… Upload rÃ©ussi: $downloadUrl';      debugPrint('[ImageUpload] âŒ Erreur upload: $e';      throw Exception('Erreur lors de l\'upload de l\'image: $e';      final fileName = '${baseFileName}_$i.jpg';      debugPrint('[ImageUpload] ğŸ—‘ï¸ Suppression image: $imageUrl';      // CrÃ©er la rÃ©fÃ©rence depuis l';      debugPrint('[ImageUpload] âœ… Suppression rÃ©ussie';      debugPrint('[ImageUpload] âŒ Erreur suppression: $e';      throw Exception('Erreur lors de la suppression de l\'image: $e';  /// ğŸ“Š Obtenir les mÃ©tadonnÃ©es d';      debugPrint('[ImageUpload] âŒ Erreur mÃ©tadonnÃ©es: $e';      throw Exception('Erreur lors de la rÃ©cupÃ©ration des mÃ©tadonnÃ©es: $e';  /// ğŸ“ Obtenir la taille d';      debugPrint('[ImageUpload] âŒ Erreur taille: $e';    return '${prefix}_$timestamp.$extension';      debugPrint('[ImageUpload] âŒ Erreur listage: $e';      debugPrint('[ImageUpload] ğŸ§¹ Nettoyage dossier: $folder';          debugPrint('[ImageUpload] ğŸ—‘ï¸ Suppression image orpheline: $imageUrl';      debugPrint('[ImageUpload] âœ… Nettoyage terminÃ©';      debugPrint('[ImageUpload] âŒ Erreur nettoyage: $e';  /// ğŸ“Š Obtenir les statistiques d';        'count';        'totalSize';        'averageSize';      debugPrint('[ImageUpload] âŒ Erreur statistiques: $e';        'count';        'totalSize';        'averageSize';      debugPrint('[ImageUpload] ğŸ”„ Copie image vers: $targetFolder/$targetFileName';      // TÃ©lÃ©charger l';        throw Exception('Impossible de tÃ©lÃ©charger l\'image source';      final targetRef = _storage.ref().child('$targetFolder/$targetFileName';      // RÃ©cupÃ©rer l';      debugPrint('[ImageUpload] âœ… Copie rÃ©ussie: $newUrl';      debugPrint('[ImageUpload] âŒ Erreur copie: $e';      throw Exception('Erreur lors de la copie de l\'image: $e';  /// ğŸ”’ VÃ©rifier les permissions d';      // Tenter d';      final testRef = _storage.ref().child('test/permission_check.txt';      await testRef.putString('test';      debugPrint('[ImageUpload] âŒ Pas de permissions d\'upload: $e';      // Pour l';      // TODO: Ajouter la compression d';      debugPrint('[ImageUpload] âŒ Erreur upload optimisÃ©: $e';        debugPrint('[ImageUpload] âŒ Tentative $attempts/$maxRetries Ã©chouÃ©e: $e';    throw Exception('Ã‰chec de l\'upload aprÃ¨s $maxRetries tentatives';